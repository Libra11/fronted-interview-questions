<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>前端如何实现截图？ - 面试题刷题</title>
  <link rel="stylesheet" href="../assets/styles.css" />
  <meta name="description" content="&lt;p&gt;前端实现截图需要使用 HTML5 的 Canvas 和相关 API，具体步骤如下：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;首先在页面中创建一个 Canvas 元素，并设置其宽高和样式。&lt;/li&gt;&lt;li&gt;使用 Canvas API 在 Canvas 上绘制需要截图的内容，比如页面的某个区域、" />
  <link rel="icon" href="../assets/favicon.svg" />
  <style>.content a{color:var(--brand);} .content img{max-width:100%;}</style>
  
  <!-- Open Graph -->
  <meta property="og:title" content="前端如何实现截图？" />
  <meta property="og:type" content="article" />
  <meta property="og:description" content="&lt;p&gt;前端实现截图需要使用 HTML5 的 Canvas 和相关 API，具体步骤如下：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;首先在页面中创建一个 Canvas 元素，并设置其宽高和样式。&lt;/li&gt;&lt;li&gt;使用 Canvas API 在 Canvas 上绘制需要截图的内容，比如页面的某个区域、某个元素、图片等。&lt;/li&gt;&lt;li&gt;调用 Canvas API 中的 &lt;code&gt;toDataURL()&lt;/code&gt; " />
  <meta property="og:locale" content="zh_CN" />
</head>
<body>
  <header class="site-header">
    <div class="container header-inner">
      <a class="logo" href="../index.html">面试题刷题</a>
      <nav class="nav">
        <a href="../index.html">首页</a>
        <a href="../index.html#categories">分类</a>
        <a href="https://github.com/pro-collection/interview-question/issues/188" target="_blank" rel="noopener">原始链接</a>
      </nav>
    </div>
  </header>
  <main class="container article">
    <div class="article-head">
      <a class="back" href="../index.html">← 返回列表</a>
      <h1>前端如何实现截图？</h1>
      <div class="subtitle">web应用场景 · web应用场景</div>
      <div class="meta">创建：2023-03-26T09:34:41Z · 更新：2025-03-05T03:53:42Z</div>
    </div>
    <article class="content markdown-body"><p>前端实现截图需要使用 HTML5 的 Canvas 和相关 API，具体步骤如下：</p><ol><li>首先在页面中创建一个 Canvas 元素，并设置其宽高和样式。</li><li>使用 Canvas API 在 Canvas 上绘制需要截图的内容，比如页面的某个区域、某个元素、图片等。</li><li>调用 Canvas API 中的 <code>toDataURL()</code> 方法将 Canvas 转化为 base64 编码的图片数据。</li><li>将 base64 编码的图片数据传递给后端进行处理或者直接在前端进行显示。</li></ol><p>以下是一个简单的例子，实现了对整个页面的截图：</p><pre class="code-block"><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;meta charset=&quot;UTF-8&quot;&gt;
    &lt;title&gt;截图示例&lt;/title&gt;
    &lt;style&gt;
      #canvas {
        position: fixed;
        left: 0;
        top: 0;
        z-index: 9999;
      }
    &lt;/style&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;h1&gt;截图示例&lt;/h1&gt;
    &lt;p&gt;这是一个简单的截图示例。&lt;/p&gt;
    &lt;button id=&quot;btn&quot;&gt;截图&lt;/button&gt;
    &lt;canvas id=&quot;canvas&quot;&gt;&lt;/canvas&gt;
    &lt;script&gt;
      const canvas = document.getElementById(&#39;canvas&#39;);
      const ctx = canvas.getContext(&#39;2d&#39;);
      const btn = document.getElementById(&#39;btn&#39;);
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;

      btn.addEventListener(&#39;click&#39;, () =&gt; {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        ctx.drawImage(document.documentElement, 0, 0);
        const imgData = canvas.toDataURL();
        console.log(imgData);
      });
    &lt;/script&gt;
  &lt;/body&gt;
&lt;/html&gt;
</code></pre><p>这个例子中，在页面中创建了一个 <code>canvas</code> 元素，并设置其宽高和样式，将其放在页面最上方。在点击“截图”按钮时，通过 <code>toDataURL()</code> 方法将整个页面的截图转换为 base64 编码的图片数据，并打印到控制台上。</p><h2>Comments / Answers</h2><hr /><p><strong>Guan-Erjia</strong> at 2023-09-12T03:20:43Z</p><p>drawImage不支持传入htmlElement</p><p>Uncaught TypeError: Failed to execute 'drawImage' on 'CanvasRenderingContext2D': The provided value is not of type '(CSSImageValue or HTMLCanvasElement or HTMLImageElement or HTMLVideoElement or ImageBitmap or OffscreenCanvas or SVGImageElement or VideoFrame)'.</p><hr /><p><strong>BruceYuj</strong> at 2025-03-04T12:44:30Z</p><p>想要将 DOM 元素截图，两种方案：</p><ol><li>直接通过 canvas 模拟 DOM 元素的外观属性，比如 <strong>文本：用 fillText 渲染文本，复制字体样式（如 font-family、font-size</strong>。类似于 html2canvas 库。</li><li>先转成 svg, 再用 canvas 绘制。类似于 dom-to-image库</li></ol><hr /><p><strong>canvascat</strong> at 2025-03-05T03:53:41Z</p><p>可以借助 getDisplayMedia 捕获窗口内容，然后通过 canvas 对捕获到的内容进行处理</p><p>https://github.com/canvascat/electron-screenshot/blob/aa6d90dcaeb3f648625f588c55486973d6398afc/src/util/util.ts#L28-L47</p><pre class="code-block"><code class="language-ts">   const stream = await navigator.mediaDevices.getDisplayMedia(); 
   const video = await new Promise( 
     (resolve: (video: HTMLVideoElement) =&gt; void, reject) =&gt; { 
       const video = document.createElement(&#39;video&#39;); 
       video.setAttribute(&#39;autoplay&#39;, &#39;true&#39;); 
       sleep(1000).then(reject); 
       video.onplay = () =&gt; resolve(video); 
       video.srcObject = stream; 
     } 
   ); 
   const { videoHeight: height, videoWidth: width } = video; 
   const canvas = document.createElement(&#39;canvas&#39;); 
   Object.assign(canvas, { height, width }); 
   canvas.getContext(&#39;2d&#39;)?.drawImage(video, 0, 0); 
   const tracks = (video.srcObject as MediaStream).getTracks(); 
   tracks.forEach((track) =&gt; track.stop()); 
   video.srcObject = null;

   // 处理 canvas
</code></pre></article>
  </main>
  <footer class="site-footer">© 面试题刷题 · 由本地静态页面生成</footer>
</body>
</html>