<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>介绍一下 navigator.sendBeacon 方法【热度: 66】 - 面试题刷题</title>
  <link rel="stylesheet" href="../assets/styles.css" />
  <meta name="description" content="&lt;p&gt;&lt;strong&gt;关键词&lt;/strong&gt;：sendBeacon 发送请求&lt;/p&gt;&lt;p&gt;&lt;code&gt;navigator.sendBeacon()&lt;/code&gt; 方法使得网页可以异步地将数据发送到服务器，与页面的卸载过程同时进行，这一点非常重要，因为它允许在不影响用户体验的情况" />
  <link rel="icon" href="../assets/favicon.svg" />
  <style>.content a{color:var(--brand);} .content img{max-width:100%;}</style>
  
  <!-- Open Graph -->
  <meta property="og:title" content="介绍一下 navigator.sendBeacon 方法【热度: 66】" />
  <meta property="og:type" content="article" />
  <meta property="og:description" content="&lt;p&gt;&lt;strong&gt;关键词&lt;/strong&gt;：sendBeacon 发送请求&lt;/p&gt;&lt;p&gt;&lt;code&gt;navigator.sendBeacon()&lt;/code&gt; 方法使得网页可以异步地将数据发送到服务器，与页面的卸载过程同时进行，这一点非常重要，因为它允许在不影响用户体验的情况下，安全地结束会话或者发送统计数据。这方法主要用于追踪和诊断信息，特别是在需要确保数据被成功发送到服务器的场景中——比如" />
  <meta property="og:locale" content="zh_CN" />
</head>
<body>
  <header class="site-header">
    <div class="container header-inner">
      <a class="logo" href="../index.html">面试题刷题</a>
      <nav class="nav">
        <a href="../index.html">首页</a>
        <a href="../index.html#categories">分类</a>
        <a href="https://github.com/pro-collection/interview-question/issues/849" target="_blank" rel="noopener">原始链接</a>
      </nav>
    </div>
  </header>
  <main class="container article">
    <div class="article-head">
      <a class="back" href="../index.html">← 返回列表</a>
      <h1>介绍一下 navigator.sendBeacon 方法【热度: 66】</h1>
      <div class="subtitle">web应用场景 · web应用场景</div>
      <div class="meta">创建：2024-08-25T06:25:47Z · 更新：2024-08-25T06:25:48Z</div>
    </div>
    <article class="content markdown-body"><p><strong>关键词</strong>：sendBeacon 发送请求</p><p><code>navigator.sendBeacon()</code> 方法使得网页可以异步地将数据发送到服务器，与页面的卸载过程同时进行，这一点非常重要，因为它允许在不影响用户体验的情况下，安全地结束会话或者发送统计数据。这方法主要用于追踪和诊断信息，特别是在需要确保数据被成功发送到服务器的场景中——比如记录用户在网页上的行为数据。</p><h3>基本语法</h3><pre class="code-block"><code class="language-javascript">navigator.sendBeacon(url, data);
</code></pre><ul><li><code>url</code>：一个字符串，代表您想要发送数据到的服务器地址。</li><li><code>data</code>：可选参数，要发送的数据。可以是 <code>ArrayBufferView</code>、<code>Blob</code>、<code>DOMString</code>、或者 <code>FormData</code> 对象。</li></ul><h3>返回值</h3><ul><li>该方法返回一个布尔值：如果浏览器成功地将请求入队进行发送，则返回 <code>true</code>；如果请求因任何原因未能入队，则返回 <code>false</code>。</li></ul><h3>特点</h3><ol><li><strong>异步</strong>：<code>sendBeacon()</code> 发送的请求是异步的，不会阻塞页面卸载过程或者延迟用户浏览器的关闭操作。</li><li><strong>小数据量</strong>：适用于发送少量数据，如统计信息和会话结束信号。</li><li><strong>不影响关闭</strong>：它允许在页面卸载或关闭时发送数据，而不会阻止或延迟页面的卸载过程。</li><li><strong>可靠</strong>：它确保数据能够在页面退出时被送出，相较于 <code>beforeunload</code> 或 <code>unload</code> 事件中使用同步的 <code>XMLHttpRequest</code> 更为可靠。</li></ol><h3>使用示例</h3><p>发送一些统计数据到服务器的简单示例：</p><pre class="code-block"><code class="language-javascript">window.addEventListener(&quot;unload&quot;, function () {
  var data = { action: &quot;leave&quot;, timestamp: Date.now() };
  navigator.sendBeacon(&quot;https://example.com/analytics&quot;, JSON.stringify(data));
});
</code></pre><p>在上面的例子中，当用户离开页面时，我们监听 <code>unload</code> 事件，并在该事件触发时使用 <code>navigator.sendBeacon()</code> 方法发送一些统计数据到服务器。使用 <code>JSON.stringify(data)</code> 将数据对象转换成字符串形式，因为 <code>sendBeacon</code> 需要发送的数据必须是文本或二进制形式。</p><h3>兼容性与限制</h3><ul><li>虽然 <code>navigator.sendBeacon()</code> 被现代浏览器广泛支持，但在使用前最好检查浏览器兼容性。</li><li>发送数据量有限制，一般适用于发送小量的数据。</li><li>某些浏览器实现可能有细微差异，建议在实际使用前进行充分测试。</li></ul><p>通过使用 <code>navigator.sendBeacon()</code>，开发者可以确保在页面卸载过程中，重要的数据能够被可靠地发送到服务器，从而改善数据收集的准确性和用户体验。</p></article>
  </main>
  <footer class="site-footer">© 面试题刷题 · 由本地静态页面生成</footer>
</body>
</html>