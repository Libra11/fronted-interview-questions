<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>[React] 为何要自己实现调度器， 而不是直接使用 requestIdleCallback ？【热度: 236】 - 面试题刷题</title>
  <link rel="stylesheet" href="../assets/styles.css" />
  <meta name="description" content="&lt;p&gt;&lt;strong&gt;关键词&lt;/strong&gt;：react 调度器 Scheduler、requestIdleCallback 使用场景&lt;/p&gt;&lt;p&gt;React 在性能优化方面的一个关键组件是调度器（Scheduler），它负责在渲染的过程中合理安排工作，以减少用户的等待时间以及" />
  <link rel="icon" href="../assets/favicon.svg" />
  <style>.content a{color:var(--brand);} .content img{max-width:100%;}</style>
  
  <!-- Open Graph -->
  <meta property="og:title" content="[React] 为何要自己实现调度器， 而不是直接使用 requestIdleCallback ？【热度: 236】" />
  <meta property="og:type" content="article" />
  <meta property="og:description" content="&lt;p&gt;&lt;strong&gt;关键词&lt;/strong&gt;：react 调度器 Scheduler、requestIdleCallback 使用场景&lt;/p&gt;&lt;p&gt;React 在性能优化方面的一个关键组件是调度器（Scheduler），它负责在渲染的过程中合理安排工作，以减少用户的等待时间以及避免单个任务占用过多的主线程时间，从而提高渲染性能。React 在 18.0 版本后引入了新的调度器机制，提供了更好的性" />
  <meta property="og:locale" content="zh_CN" />
</head>
<body>
  <header class="site-header">
    <div class="container header-inner">
      <a class="logo" href="../index.html">面试题刷题</a>
      <nav class="nav">
        <a href="../index.html">首页</a>
        <a href="../index.html#categories">分类</a>
        <a href="https://github.com/pro-collection/interview-question/issues/717" target="_blank" rel="noopener">原始链接</a>
      </nav>
    </div>
  </header>
  <main class="container article">
    <div class="article-head">
      <a class="back" href="../index.html">← 返回列表</a>
      <h1>[React] 为何要自己实现调度器， 而不是直接使用 requestIdleCallback ？【热度: 236】</h1>
      <div class="subtitle">web框架 · web框架 · 阿里巴巴</div>
      <div class="meta">创建：2024-04-20T06:11:31Z · 更新：2024-04-20T06:11:31Z</div>
    </div>
    <article class="content markdown-body"><p><strong>关键词</strong>：react 调度器 Scheduler、requestIdleCallback 使用场景</p><p>React 在性能优化方面的一个关键组件是调度器（Scheduler），它负责在渲染的过程中合理安排工作，以减少用户的等待时间以及避免单个任务占用过多的主线程时间，从而提高渲染性能。React 在 18.0 版本后引入了新的调度器机制，提供了更好的性能体验。</p><p>那么，为什么 React 不直接使用 <code>requestIdleCallback</code> 而要自己实现调度器呢？</p><ol><li><strong>控制精细度：</strong> React 需要比 <code>requestIdleCallback</code> 更高的控制精细度。<code>requestIdleCallback</code> 是基于浏览器的空闲时间进行调度的，而 React 调度器可以根据组件优先级、更新的紧急程度等信息，更精确地安排渲染的工作。</li></ol><ol><li><strong>跨浏览器兼容性：</strong> <code>requestIdleCallback</code> 直到 2018 年才是浏览器中较普遍支持的 API。React 需要一个能够跨各个版本或框架的解决方案，以实现一致的性能体验。</li></ol><ol><li><strong>时间切片：</strong> React 使用一种称为“时间切片”（time slicing）的技术，允许组件分布在多个帧中渲染以维持流畅的 UI。这依赖于 React 自己对任务和帧的精确控制，而不是依赖浏览器的 <code>requestIdleCallback</code>。</li></ol><ol><li><strong>更丰富的特性：</strong> React 调度器提供了比 <code>requestIdleCallback</code> 更丰富的特性和更加详细的调度策略，这包括：</li></ol><ul><li><code>Immediate</code> 模式，用于同步渲染，当它是必需的时候。</li><li><code>User-blocking</code> 模式，用于任务需要尽快完成，但能够容忍一定延迟，比如交互动画。</li><li><code>Normal</code> 和 <code>Low</code> 模式，用于不同优先级的更新。</li></ul><ol><li><strong>复杂功能的实现：</strong> React 使用调度器实现某些特定的特性，比如：</li></ol><ul><li>Fiber 架构，允许 React 在类组件上实现 Concurrent 特性。</li><li>在客户端渲染和服务器端渲染之间实现一致性。</li></ul><ol><li><strong>优化生态工具：</strong> 对于 React 生态中的其他工具和实现（如 react-native、fast-refresh 等），它们可能需要特定或不同的调度策略。</li></ol><ol><li><strong>未来兼容性：</strong> React 团队可以更好地在自己控制的调度器中实现未来的优化和特性，而不受浏览器 API 变更的影响。</li></ol><p>最后，调度器是 React 架构中的一个重要部分，它让 React 能够实现更丰富和灵活的用户界面渲染逻辑。尽管 <code>requestIdleCallback</code> 可以被用来实现一些调度器的特性，但是完全使用它将限制 React 进一步优化的可能性，并迫使 React 依赖于浏览器的调度行为，这可能不符合 React 的长期发展和技术策略。</p></article>
  </main>
  <footer class="site-footer">© 面试题刷题 · 由本地静态页面生成</footer>
</body>
</html>