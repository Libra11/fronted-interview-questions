<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>promise 是否可以取消？ - 面试题刷题</title>
  <link rel="stylesheet" href="../assets/styles.css" />
  <meta name="description" content="&lt;p&gt;在原生的 JavaScript Promise 中，它没有内建的取消机制。一旦一个 Promise 被创建并开始执行，就无法直接取消它。&lt;/p&gt;&lt;p&gt;通常情况下，Promise 一旦被创建，就会一直执行直到成功(resolve)或失败(reject)。但是，你可以通过一些手" />
  <link rel="icon" href="../assets/favicon.svg" />
  <style>.content a{color:var(--brand);} .content img{max-width:100%;}</style>
  
  <!-- Open Graph -->
  <meta property="og:title" content="promise 是否可以取消？" />
  <meta property="og:type" content="article" />
  <meta property="og:description" content="&lt;p&gt;在原生的 JavaScript Promise 中，它没有内建的取消机制。一旦一个 Promise 被创建并开始执行，就无法直接取消它。&lt;/p&gt;&lt;p&gt;通常情况下，Promise 一旦被创建，就会一直执行直到成功(resolve)或失败(reject)。但是，你可以通过一些手动的方式来模拟取消 Promise 的效果。下面是几种常见的方法：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;忽略 Promise 的结果：" />
  <meta property="og:locale" content="zh_CN" />
</head>
<body>
  <header class="site-header">
    <div class="container header-inner">
      <a class="logo" href="../index.html">面试题刷题</a>
      <nav class="nav">
        <a href="../index.html">首页</a>
        <a href="../index.html#categories">分类</a>
        <a href="https://github.com/pro-collection/interview-question/issues/291" target="_blank" rel="noopener">原始链接</a>
      </nav>
    </div>
  </header>
  <main class="container article">
    <div class="article-head">
      <a class="back" href="../index.html">← 返回列表</a>
      <h1>promise 是否可以取消？</h1>
      <div class="subtitle">百度 · JavaScript · 百度</div>
      <div class="meta">创建：2023-04-16T15:41:38Z · 更新：2023-05-23T14:58:45Z</div>
    </div>
    <article class="content markdown-body"><p>在原生的 JavaScript Promise 中，它没有内建的取消机制。一旦一个 Promise 被创建并开始执行，就无法直接取消它。</p><p>通常情况下，Promise 一旦被创建，就会一直执行直到成功(resolve)或失败(reject)。但是，你可以通过一些手动的方式来模拟取消 Promise 的效果。下面是几种常见的方法：</p><ol><li>忽略 Promise 的结果：当你不关心 Promise 的结果时，你可以选择忽略它。这意味着你不会处理 Promise 的 resolve 或 reject 回调函数，也不会将结果传递给其他地方。这样做相当于"取消"了对 Promise 结果的关注。</li></ol><ol><li>基于标志位的取消机制：你可以创建一个标志位变量，并在 Promise 的执行过程中检查该变量。如果标志位被设置为取消状态，你可以选择终止 Promise 的执行，例如抛出一个特定的错误或执行一个不会产生影响的操作。</li></ol><ol><li>使用第三方库：有一些第三方库，如<code>p-cancelable</code>和<code>cancelable-promise</code>，提供了可取消 Promise 的功能。这些库通过封装 Promise，提供了额外的方法来取消 Promise 的执行。</li></ol><p>需要注意的是，虽然你可以使用上述方法来模拟取消 Promise 的效果，但它们并不是 Promise 的原生功能。在实际开发中，如果你需要取消异步操作，可能需要使用其他异步编程模型或使用支持取消操作的第三方库。</p><p><strong>以下是几个使用例子</strong>，展示了如何通过不同的方式模拟取消 Promise 的效果：</p><ol><li>忽略 Promise 的结果：</li></ol><pre class="code-block"><code class="language-javascript">const promise = new Promise((resolve, reject) =&gt; {
  // 执行异步操作...
});

// 不处理 Promise 的结果
</code></pre><p>在上述示例中，我们创建了一个 Promise，但没有处理它的 resolve 或 reject 回调函数。这意味着我们不关心 Promise 的结果，相当于忽略了它。</p><ol><li>基于标志位的取消机制：</li></ol><pre class="code-block"><code class="language-javascript">let canceled = false;

const promise = new Promise((resolve, reject) =&gt; {
  // 执行异步操作...
  if (canceled) {
    reject(new Error(&#39;Promise canceled&#39;));
  } else {
    // 继续正常处理
  }
});

// 在需要取消 Promise 的时候，将 canceled 标志位设置为 true
canceled = true;
</code></pre><p>在上述示例中，我们创建了一个标志位变量<code>canceled</code>，并在 Promise 的执行过程中检查该变量。如果<code>canceled</code>被设置为<code>true</code>，我们选择拒绝 Promise，并传递一个特定的错误作为原因，表示 Promise 被取消。</p><ol><li>使用第三方库：</li></ol><pre class="code-block"><code class="language-javascript">import PCancelable from &#39;p-cancelable&#39;;

const promise = new PCancelable((resolve, reject, onCancel) =&gt; {
  // 执行异步操作...

  // 注册取消回调函数
  onCancel(() =&gt; {
    // 在取消时执行清理操作...
  });
});

// 取消 Promise
promise.cancel();
</code></pre><p>在上述示例中，我们使用第三方库<code>p-cancelable</code>，它提供了可取消 Promise 的功能。我们创建了一个<code>PCancelable</code>实例，并在 Promise 的执行过程中注册了一个取消回调函数。通过调用<code>promise.cancel()</code>方法，我们可以取消 Promise 的执行，并触发取消回调函数。</p><p>这些例子展示了如何通过不同的方式模拟取消 Promise 的效果。请注意，这些方法并不是 Promise 的原生功能，而是通过不同的实现方式来达到类似的效果。</p><h2>Comments / Answers</h2><hr /><p><strong>diaoluodejc</strong> at 2023-05-22T07:30:00Z</p><p>印错卷子了？</p><hr /><p><strong>yanlele</strong> at 2023-05-23T14:45:30Z</p><blockquote>印错卷子了？</blockquote><p>@diaoluodejc 还真的是印错卷子了；感谢提醒</p></article>
  </main>
  <footer class="site-footer">© 面试题刷题 · 由本地静态页面生成</footer>
</body>
</html>