<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>nodejs 如何充分利用多核 CPU?【热度: 725】 - 面试题刷题</title>
  <link rel="stylesheet" href="../assets/styles.css" />
  <meta name="description" content="&lt;p&gt;&lt;strong&gt;关键词&lt;/strong&gt;：nodejs 多CPU使用&lt;/p&gt;&lt;p&gt;总所周知， NodeJS 是单线程执行任务， 不同于 浏览器还可以使用 web worker 等手段多线程执行任务。那么 NodeJS 中， 是如何充分利用物理机的多核 CPU 呢？&lt;/p&gt;&lt;" />
  <link rel="icon" href="../assets/favicon.svg" />
  <style>.content a{color:var(--brand);} .content img{max-width:100%;}</style>
  
  <!-- Open Graph -->
  <meta property="og:title" content="nodejs 如何充分利用多核 CPU?【热度: 725】" />
  <meta property="og:type" content="article" />
  <meta property="og:description" content="&lt;p&gt;&lt;strong&gt;关键词&lt;/strong&gt;：nodejs 多CPU使用&lt;/p&gt;&lt;p&gt;总所周知， NodeJS 是单线程执行任务， 不同于 浏览器还可以使用 web worker 等手段多线程执行任务。那么 NodeJS 中， 是如何充分利用物理机的多核 CPU 呢？&lt;/p&gt;&lt;h3&gt;有三种方式&lt;/h3&gt;&lt;p&gt;在 Node.js 中，JS 也是单线程的，只有一个主线程用于执行任务。但是，在 Nod" />
  <meta property="og:locale" content="zh_CN" />
</head>
<body>
  <header class="site-header">
    <div class="container header-inner">
      <a class="logo" href="../index.html">面试题刷题</a>
      <nav class="nav">
        <a href="../index.html">首页</a>
        <a href="../index.html#categories">分类</a>
        <a href="https://github.com/pro-collection/interview-question/issues/641" target="_blank" rel="noopener">原始链接</a>
      </nav>
    </div>
  </header>
  <main class="container article">
    <div class="article-head">
      <a class="back" href="../index.html">← 返回列表</a>
      <h1>nodejs 如何充分利用多核 CPU?【热度: 725】</h1>
      <div class="subtitle">Nodejs · Nodejs · 阿里巴巴</div>
      <div class="meta">创建：2023-11-16T15:48:37Z · 更新：2023-11-16T15:52:31Z</div>
    </div>
    <article class="content markdown-body"><p><strong>关键词</strong>：nodejs 多CPU使用</p><p>总所周知， NodeJS 是单线程执行任务， 不同于 浏览器还可以使用 web worker 等手段多线程执行任务。那么 NodeJS 中， 是如何充分利用物理机的多核 CPU 呢？</p><h3>有三种方式</h3><p>在 Node.js 中，JS 也是单线程的，只有一个主线程用于执行任务。但是，在 Node.js 中可以使用多进程来利用多核机器，以充分利用系统资源。</p><ul><li><strong>Node.js 提供了 <code>cluster</code> 模块</strong>，可以轻松创建子进程来处理任务。通过将任务分配给不同的子进程，每个子进程可以在自己的线程上执行任务，从而实现多核机器的利用。</li></ul><ul><li><strong>Node.js 也提供了 <code>worker_threads</code> 模块</strong>，可以创建真正的多线程应用程序。这个模块允许开发者创建和管理多个工作线程，每个线程都可以独立地执行任务。</li></ul><ul><li><strong>利用的是 Node.js 的事件循环机制和异步非阻塞的 I/O 操作</strong>。Node.js 使用事件驱动的模型来处理请求，当有请求到达时，Node.js 将其放入事件队列中，然后通过事件循环来处理这些请求。在等待 I/O 操作的过程中，Node.js 不会阻塞其他请求的处理，而是继续处理其他请求。这样，即使 JavaScript 是单线程的，但在实际运行中，多个请求可以同时处理，充分利用了多核系统的能力。</li></ul><h3>如果 Nodejs 只写同步代码， 是否意味着无法充分利用多核优势？</h3><p>如果在 Node.js 的开发过程中只使用同步代码而不使用异步代码或集群模块，<strong>那么意味着无法充分利用机器多核优势</strong>。</p><p>Node.js的事件驱动和异步非阻塞的特性使得它在处理大量并发请求时非常高效。当你使用异步代码时，可以在等待 I/O 操作的过程中继续处理其他请求，从而提高系统的吞吐量和响应速度。而同步代码会阻塞事件循环，使得只能按顺序处理请求，无法同时处理多个请求，无法充分利用多核系统的能力。</p><p>另外，如果你不使用集群模块，那么只有一个 Node.js 进程在运行，无法充分利用多核系统的资源。使用集群模块可以创建多个子进程，每个子进程在一个核心上运行，从而并行处理请求，提高系统的并发能力。</p><h3>为何 nodejs 异步代码就可以充分利用多核优势了？</h3><p>Node.js的异步代码可以充分利用多核优势，主要有两个原因：</p><ol><li>事件驱动和非阻塞 I/O：Node.js采用事件驱动的模型，通过使用异步非阻塞 I/O 操作，可以在等待 I/O 操作完成的同时继续处理其他请求。这意味着在一个请求等待 I/O 的过程中，Node.js 可以同时处理其他请求，充分利用了 CPU 的多核能力。每个核心可以处理一个请求，从而提高系统的并发能力和吞吐量。</li></ol><ol><li>事件循环机制：Node.js的事件循环机制使得异步代码可以高效地处理大量并发请求。事件循环机制通过将请求注册为事件监听器，并在合适的时候触发事件处理函数，从而实现异步处理。这样一来，即使有大量并发请求，也能够通过事件循环机制避免线程切换的开销，提高系统的性能。</li></ol><p>需要注意的是，虽然 Node.js 的事件驱动和异步非阻塞的特性使得它能够充分利用多核优势，但是在处理 CPU 密集型任务时，仍然可能受限于单线程的性能。在这种情况下，可以通过使用集群模块来创建多个子进程，在每个核心上运行独立的 Node.js 进程，从而实现并行处理，提高系统的性能。</p><h3>异步就能充分利用 CPU 原理是啥？</h3><p>当Node.js使用异步代码时，服务器的其他CPU核心是在工作的。</p><p>这是因为Node.js的事件驱动模型和非阻塞I/O使得在等待I/O操作完成时，可以同时处理其他请求。</p><p>当一个请求在等待I/O操作时，CPU核心可以被用于处理其他请求，而不是空闲等待。</p><p>这种方式可以充分利用服务器上的多个CPU核心，提高系统的并发能力和吞吐量。通过同时处理多个请求，可以更有效地利用服务器的资源，提高系统的性能。</p><h2>Comments / Answers</h2><hr /><p><strong>yanlele</strong> at 2023-11-16T15:52:29Z</p><p>参考文档： https://juejin.cn/post/7062733724504293413</p></article>
  </main>
  <footer class="site-footer">© 面试题刷题 · 由本地静态页面生成</footer>
</body>
</html>