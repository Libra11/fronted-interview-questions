<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>[React] useState 的原理是什么，背后怎么执行的【热度: 446】 - 面试题刷题</title>
  <link rel="stylesheet" href="../assets/styles.css" />
  <meta name="description" content="&lt;p&gt;&lt;strong&gt;关键词&lt;/strong&gt;：useState 的原理&lt;/p&gt;&lt;p&gt;&lt;code&gt;useState&lt;/code&gt; 是 React 库中的一个 Hook，它允许你在函数组件中添加 React 状态。使用 &lt;code&gt;useState&lt;/code&gt;，你可以给组件添加内" />
  <link rel="icon" href="../assets/favicon.svg" />
  <style>.content a{color:var(--brand);} .content img{max-width:100%;}</style>
  
  <!-- Open Graph -->
  <meta property="og:title" content="[React] useState 的原理是什么，背后怎么执行的【热度: 446】" />
  <meta property="og:type" content="article" />
  <meta property="og:description" content="&lt;p&gt;&lt;strong&gt;关键词&lt;/strong&gt;：useState 的原理&lt;/p&gt;&lt;p&gt;&lt;code&gt;useState&lt;/code&gt; 是 React 库中的一个 Hook，它允许你在函数组件中添加 React 状态。使用 &lt;code&gt;useState&lt;/code&gt;，你可以给组件添加内部状态，并且能够通过调用这个 Hook 来更新状态，从而触发组件的重新渲染。&lt;/p&gt;&lt;h3&gt;原理简述&lt;/h3&gt;&lt;p&gt;&lt;c" />
  <meta property="og:locale" content="zh_CN" />
</head>
<body>
  <header class="site-header">
    <div class="container header-inner">
      <a class="logo" href="../index.html">面试题刷题</a>
      <nav class="nav">
        <a href="../index.html">首页</a>
        <a href="../index.html#categories">分类</a>
        <a href="https://github.com/pro-collection/interview-question/issues/818" target="_blank" rel="noopener">原始链接</a>
      </nav>
    </div>
  </header>
  <main class="container article">
    <div class="article-head">
      <a class="back" href="../index.html">← 返回列表</a>
      <h1>[React] useState 的原理是什么，背后怎么执行的【热度: 446】</h1>
      <div class="subtitle">web框架 · web框架 · TOP100互联网</div>
      <div class="meta">创建：2024-08-10T04:22:36Z · 更新：2024-08-10T04:22:36Z</div>
    </div>
    <article class="content markdown-body"><p><strong>关键词</strong>：useState 的原理</p><p><code>useState</code> 是 React 库中的一个 Hook，它允许你在函数组件中添加 React 状态。使用 <code>useState</code>，你可以给组件添加内部状态，并且能够通过调用这个 Hook 来更新状态，从而触发组件的重新渲染。</p><h3>原理简述</h3><p><code>useState</code> 的工作原理基于 React 的渲染机制和 Fiber 架构。以下是 <code>useState</code> 工作流程的简要概述：</p><ol><li><strong>初始化状态</strong>：当你在函数组件中调用 <code>useState</code> 时，React 会为该组件创建一个状态变量。如果提供了初始值，状态将被初始化为该值。</li></ol><ol><li><strong>返回更新函数</strong>：<code>useState</code> 返回一个数组，包含当前的状态值和一个更新该状态的函数（通常命名为 <code>setState</code>）。</li></ol><ol><li><strong>调用更新函数</strong>：当你调用这个更新函数并传入一个新的状态值时，React 会将这个新的状态值与当前状态合并，并计划重新渲染组件。</li></ol><ol><li><strong>重新渲染</strong>：在下一次的渲染周期中，React 会使用新的状态值重新渲染组件。</li></ol><ol><li><strong>状态持久化</strong>：React 通过内部机制确保状态在组件的多次渲染之间保持不变。</li></ol><h3>执行过程</h3><p>以下是 <code>useState</code> 在 React 内部可能的执行过程：</p><ol><li><strong>调用 useState</strong>：在函数组件中调用 <code>useState(initialState)</code>。</li></ol><ol><li><strong>创建状态对象</strong>：React 创建一个状态对象，存储状态值和与之关联的更新函数。</li></ol><ol><li><strong>渲染组件</strong>：使用当前的状态值渲染组件。</li></ol><ol><li><strong>更新状态</strong>：当组件需要更新状态时，调用由 <code>useState</code> 返回的更新函数，例如 <code>setState(newState)</code>。</li></ol><ol><li><strong>调度更新</strong>：React 将更新调度到下一个渲染周期，并标记组件为需要重新渲染。</li></ol><ol><li><strong>批量处理</strong>：React 可能会将多个状态更新批处理在一起，以避免不必要的多次渲染。</li></ol><ol><li><strong>重新渲染组件</strong>：在下一个渲染周期，React 使用新的状态值重新渲染组件。</li></ol><ol><li><strong>状态持久化</strong>：React 的状态持久化机制确保即使在组件卸载和重新挂载后，状态也能被正确地恢复。</li></ol><h3>代码示例</h3><pre class="code-block"><code class="language-javascript">import React, { useState } from &quot;react&quot;;

function Counter() {
  const [count, setCount] = useState(0); // 初始化状态为 0

  return (
    &lt;div&gt;
      &lt;p&gt;Count: {count}&lt;/p&gt;
      &lt;button onClick={() =&gt; setCount(count + 1)}&gt;Increment&lt;/button&gt;
    &lt;/div&gt;
  );
}
</code></pre><p>在这个例子中，<code>useState</code> 被用来初始化 <code>count</code> 状态，并提供了一个 <code>setCount</code> 函数来更新它。每次点击按钮时，<code>setCount</code> 被调用，React 计划重新渲染组件，并在下一次渲染周期中使用新的状态值。</p></article>
  </main>
  <footer class="site-footer">© 面试题刷题 · 由本地静态页面生成</footer>
</body>
</html>