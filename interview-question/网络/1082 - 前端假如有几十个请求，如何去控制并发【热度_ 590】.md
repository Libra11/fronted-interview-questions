# 前端假如有几十个请求，如何去控制并发【热度: 590】

- Issue: #1082
- State: open
- Labels: 网络
- Author: yanlele
- URL: https://github.com/pro-collection/interview-question/issues/1082
- Created: 2025-01-09T15:37:24Z
- Updated: 2025-02-14T06:52:49Z

## Body

**关键词**：并发请求处理

1. **使用`Promise.allSettled`和分批处理**：将请求按并发限制分成小批次，用`Promise.allSettled`逐批执行，如`fetchWithConcurrency`函数，通过循环取批次并处理，最后返回所有结果。
2. **使用队列方式控制并发**：`PromiseQueue`类通过限制同时运行的`Promise`数量管理并发，有`enqueue`方法添加任务，`runNext`方法按规则执行任务，使用时创建实例并传入并发数，将请求任务入队后用`Promise.all`执行。
3. **使用第三方库**
   - **`p - limit`**：引入后设置最大并发数，将请求任务用其包裹后用`Promise.all`执行。
   - **`promise - pool`**：引入后配置请求数组、并发数和任务函数，执行`promisePool`获取结果。
4. **浏览器专用：`AbortController`限制超时**：`fetchWithTimeout`函数利用`AbortController`结合超时机制，在超时后中止请求，处理请求时传入`signal`，捕获错误并在最后清除超时。
5. **选择建议**
   - 任务数量多但单任务时间短，适合分批处理或`PromiseQueue`。
   - 任务数量多且复杂，建议用`p - limit`等库。
   - 实时性要求高，可考虑`AbortController`或合理设置超时策略。

- 参考文档
  https://juejin.cn/post/7457511148513443850


## Comments / Answers

---

**weiizxuan** at 2025-02-14T06:52:49Z

> 浏览器对同一域名的并发请求数有限制（通常是 6~8 个），超过限制的请求会被放入队列等待

浏览器已经帮你控制过了，哪怕是IE6
而且就算浏览器没有控制并发，几十个用户同时发送请求的情况呢？前端怎么处理？
所以说**前端根本就无需处理并发**
