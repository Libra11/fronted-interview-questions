<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>为什么普通 for 循环的性能远远高于 forEach 的性能？ - 面试题刷题</title>
  <link rel="stylesheet" href="../assets/styles.css" />
  <meta name="description" content="&lt;h3&gt;首先问题说&quot;for循环优于forEach&quot;并不完全正确&lt;/h3&gt;&lt;p&gt;循环次数不够多的时候， forEach 性能优于 for&lt;/p&gt;&lt;pre class=&quot;code-block&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;// 循环十万次 let arrs =" />
  <link rel="icon" href="../assets/favicon.svg" />
  <style>.content a{color:var(--brand);} .content img{max-width:100%;}</style>
  
  <!-- Open Graph -->
  <meta property="og:title" content="为什么普通 for 循环的性能远远高于 forEach 的性能？" />
  <meta property="og:type" content="article" />
  <meta property="og:description" content="&lt;h3&gt;首先问题说&quot;for循环优于forEach&quot;并不完全正确&lt;/h3&gt;&lt;p&gt;循环次数不够多的时候， forEach 性能优于 for&lt;/p&gt;&lt;pre class=&quot;code-block&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;// 循环十万次 let arrs = new Array(100000); console.time(&amp;#39;for&amp;#39;); for (let i " />
  <meta property="og:locale" content="zh_CN" />
</head>
<body>
  <header class="site-header">
    <div class="container header-inner">
      <a class="logo" href="../index.html">面试题刷题</a>
      <nav class="nav">
        <a href="../index.html">首页</a>
        <a href="../index.html#categories">分类</a>
        <a href="https://github.com/pro-collection/interview-question/issues/259" target="_blank" rel="noopener">原始链接</a>
      </nav>
    </div>
  </header>
  <main class="container article">
    <div class="article-head">
      <a class="back" href="../index.html">← 返回列表</a>
      <h1>为什么普通 for 循环的性能远远高于 forEach 的性能？</h1>
      <div class="subtitle">JavaScript · JavaScript</div>
      <div class="meta">创建：2023-04-08T14:48:47Z · 更新：2023-04-08T14:48:48Z</div>
    </div>
    <article class="content markdown-body"><h3>首先问题说"for循环优于forEach"并不完全正确</h3><p>循环次数不够多的时候， forEach 性能优于 for</p><pre class="code-block"><code class="language-js">// 循环十万次
let arrs = new Array(100000);

console.time(&#39;for&#39;);
for (let i = 0; i &lt; arrs.length; i++) {};
console.timeEnd(&#39;for&#39;); // for: 2.36474609375 ms

console.time(&#39;forEach&#39;);
arrs.forEach((arr) =&gt; {});
console.timeEnd(&#39;forEach&#39;); // forEach: 0.825927734375 ms
</code></pre><p>循环次数越大， for 的性能优势越明显</p><pre class="code-block"><code class="language-js">// 循环 1 亿次
let arrs = new Array(100000000);

console.time(&#39;for&#39;);
for (let i = 0; i &lt; arrs.length; i++) {};
console.timeEnd(&#39;for&#39;); // for: 72.7099609375 ms

console.time(&#39;forEach&#39;);
arrs.forEach((arr) =&gt; {});
console.timeEnd(&#39;forEach&#39;); // forEach: 923.77392578125 ms
</code></pre><h3>先做一下对比</h3><p>|对比类型|for|forEach|</p><p>|:---|:---|:---|</p><p>|遍历|for循环按顺序遍历|forEach 使用 iterator 迭代器遍历|</p><p>|数据结构|for循环是随机访问元素|forEach 是顺序链表访问元素|</p><p>|性能上|对于arraylist，是顺序表，使用for循环可以顺序访问，速度较快；使用foreach会比for循环稍慢一些|对于linkedlist，是单链表，使用for循环每次都要从第一个元素读取next域来读取，速度非常慢；使用foreach可以直接读取当前结点，数据较快|</p><h3>结论</h3><p>for 性能优于 forEach ， 主要原因如下：</p><ol><li>foreach相对于for循环，代码减少了，但是foreach依赖IEnumerable。在运行的时候效率低于for循环。</li><li>for循环没有额外的函数调用栈和上下文，所以它的实现最为简单。forEach：对于forEach来说，它的函数签名中包含了参数和上下文，所以性能会低于 for 循环。</li></ol><h3>参考文档</h3><ul><li>https://zhuanlan.zhihu.com/p/461523927</li><li><a href="https://www.zhihu.com/question/556786869/answer/2706658837" target="_blank" rel="noopener">javascript 中 for 的性能比 forEach 的性能要好，为何还要使用 forEach？ - 李十三的回答 - 知乎</a></li><li>https://juejin.cn/post/6844904159938887687</li></ul></article>
  </main>
  <footer class="site-footer">© 面试题刷题 · 由本地静态页面生成</footer>
</body>
</html>