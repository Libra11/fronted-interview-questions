<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>WebSocket 协议的底层原理是什么【热度: 1,805】 - 面试题刷题</title>
  <link rel="stylesheet" href="../assets/styles.css" />
  <meta name="description" content="&lt;p&gt;&lt;strong&gt;关键词&lt;/strong&gt;：WebSocket 协议、WebSocket 与 http 区别、全双工通信的协议&lt;/p&gt;&lt;h3&gt;WebSocket 通信原理&lt;/h3&gt;&lt;p&gt;WebSocket 是一种在Web浏览器和服务器之间进行全双工通信的协议，它通过一个长久的" />
  <link rel="icon" href="../assets/favicon.svg" />
  <style>.content a{color:var(--brand);} .content img{max-width:100%;}</style>
  
  <!-- Open Graph -->
  <meta property="og:title" content="WebSocket 协议的底层原理是什么【热度: 1,805】" />
  <meta property="og:type" content="article" />
  <meta property="og:description" content="&lt;p&gt;&lt;strong&gt;关键词&lt;/strong&gt;：WebSocket 协议、WebSocket 与 http 区别、全双工通信的协议&lt;/p&gt;&lt;h3&gt;WebSocket 通信原理&lt;/h3&gt;&lt;p&gt;WebSocket 是一种在Web浏览器和服务器之间进行全双工通信的协议，它通过一个长久的、双向的通信通道来实现实时数据传输。&lt;/p&gt;&lt;p&gt;下面是WebSocket协议的底层原理：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;握手（" />
  <meta property="og:locale" content="zh_CN" />
</head>
<body>
  <header class="site-header">
    <div class="container header-inner">
      <a class="logo" href="../index.html">面试题刷题</a>
      <nav class="nav">
        <a href="../index.html">首页</a>
        <a href="../index.html#categories">分类</a>
        <a href="https://github.com/pro-collection/interview-question/issues/360" target="_blank" rel="noopener">原始链接</a>
      </nav>
    </div>
  </header>
  <main class="container article">
    <div class="article-head">
      <a class="back" href="../index.html">← 返回列表</a>
      <h1>WebSocket 协议的底层原理是什么【热度: 1,805】</h1>
      <div class="subtitle">百度 · 网络 · 百度</div>
      <div class="meta">创建：2023-05-22T12:49:38Z · 更新：2023-05-22T12:49:39Z</div>
    </div>
    <article class="content markdown-body"><p><strong>关键词</strong>：WebSocket 协议、WebSocket 与 http 区别、全双工通信的协议</p><h3>WebSocket 通信原理</h3><p>WebSocket 是一种在Web浏览器和服务器之间进行全双工通信的协议，它通过一个长久的、双向的通信通道来实现实时数据传输。</p><p>下面是WebSocket协议的底层原理：</p><ol><li>握手（Handshake）：WebSocket连接的建立需要通过HTTP握手来升级到WebSocket协议。客户端首先发送一个HTTP请求，其中包含一些特定的头部信息，表明客户端希望升级到WebSocket协议。服务器收到请求后，如果支持WebSocket协议，就会返回一个带有特定头部的HTTP响应，表示握手成功。握手完成后，连接从HTTP协议切换到了WebSocket协议。</li></ol><ol><li>数据帧（Data Frames）：一旦握手成功，WebSocket连接就处于打开状态，可以进行数据传输。数据以数据帧的形式在客户端和服务器之间进行传输。数据帧是WebSocket协议中的基本单位，它包含了有效负载（payload）和一些控制信息。有效负载可以是文本数据或二进制数据。</li></ol><ol><li>帧格式（Frame Format）：WebSocket数据帧的格式相对简单。它以字节流的形式进行传输，通常由以下几个部分组成：</li></ol><ul><li>FIN（1 bit）：表示消息是否已完成，如果消息只占用一个帧，该位为1，否则为0。</li><li>RSV1、RSV2、RSV3（各占1 bit）：用于扩展使用，目前很少使用。</li><li>Opcode（4 bits）：表示消息类型，例如文本数据、二进制数据、连接关闭等。</li><li>Mask（1 bit）：指示是否对有效负载进行掩码处理。</li><li>Payload Length（7 bits或16 bits或64 bits）：表示有效负载的长度。</li><li>Masking Key（0或32 bits）：如果Mask位为1，表示用于对有效负载进行掩码处理的密钥。</li><li>Payload Data：实际的有效负载数据。</li></ul><ol><li>数据传输：数据通过TCP连接进行传输。WebSocket建立在TCP协议之上，利用TCP的可靠性和双向通信能力来传输数据。客户端和服务器可以随时发送数据帧，数据帧可以被分割成多个TCP包进行传输，接收方会将这些包重新组装成完整的数据帧。</li></ol><ol><li>心跳机制：为了保持连接的活跃状态，WebSocket使用心跳机制来定期发送心跳消息。这些心跳消息可以是空的数据帧或特定的控制帧，服务器可以通过检测心跳消息来确定连接是否仍然有效。</li></ol><p>通过以上步骤，WebSocket协议能够在浏览器和服务器之间建立一个持久的、全双工的通信通道，实现实时的双向数据传输。相比传统的HTTP请求，WebSocket减少了通信的延迟，并且能够更高效地进行实时数据交换。</p><h3>WebSocket 协议 和 http 协议有什么区别</h3><p>WebSocket协议和HTTP协议有以下几个主要区别：</p><ol><li>连接方式：HTTP协议是基于请求-响应模式的，每次请求都需要建立一个新的连接，并在响应完成后立即关闭连接。而WebSocket协议通过一次握手连接后，保持长久的双向连接，允许服务器主动向客户端推送数据，实现实时的双向通信。</li></ol><ol><li>数据格式：HTTP协议传输的数据一般采用文本或二进制的形式，但每次请求和响应都需要包含HTTP头部信息，使得数据传输的开销较大。WebSocket协议支持以原始的二进制格式进行数据传输，减少了数据传输的开销，并且提供了更低的延迟。</li></ol><ol><li>通信效率：由于HTTP协议每次请求都需要建立和关闭连接，对于频繁的数据交换场景效率较低。而WebSocket协议通过保持长连接，避免了多次建立连接的开销，从而提高了通信的效率。</li></ol><ol><li>服务器推送：HTTP协议是一种单向的协议，客户端需要不断地向服务器发送请求以获取数据。而WebSocket协议支持服务器主动向客户端推送数据，服务器可以随时向客户端发送消息，实现实时的双向通信。</li></ol><p>综上所述，WebSocket协议相比HTTP协议在实时通信和双向通信方面更加高效和灵活，适用于需要实时数据传输和双向交互的应用场景，如在线聊天、实时游戏、股票行情等。而HTTP协议则适用于传统的请求-响应模式的数据交换，如网页浏览、文件下载等。</p></article>
  </main>
  <footer class="site-footer">© 面试题刷题 · 由本地静态页面生成</footer>
</body>
</html>