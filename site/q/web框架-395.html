<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>[vue] vue3 性能提升主要是体现在哪些方面【热度: 324】 - 面试题刷题</title>
  <link rel="stylesheet" href="../assets/styles.css" />
  <meta name="description" content="&lt;p&gt;&lt;strong&gt;关键词&lt;/strong&gt;：vue3 性能提升、vue3 编译优化、vue3 初始化优化、vue3 Tree-shaking支持、vue3 虚拟DOM优化&lt;/p&gt;&lt;p&gt;Vue 3.0在性能方面进行了多项改进和优化，主要体现在以下几个方面：&lt;/p&gt;&lt;ol&gt;&lt;li" />
  <link rel="icon" href="../assets/favicon.svg" />
  <style>.content a{color:var(--brand);} .content img{max-width:100%;}</style>
  
  <!-- Open Graph -->
  <meta property="og:title" content="[vue] vue3 性能提升主要是体现在哪些方面【热度: 324】" />
  <meta property="og:type" content="article" />
  <meta property="og:description" content="&lt;p&gt;&lt;strong&gt;关键词&lt;/strong&gt;：vue3 性能提升、vue3 编译优化、vue3 初始化优化、vue3 Tree-shaking支持、vue3 虚拟DOM优化&lt;/p&gt;&lt;p&gt;Vue 3.0在性能方面进行了多项改进和优化，主要体现在以下几个方面：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;响应式系统优化：Vue 3.0使用了基于Proxy的响应式系统，相比Vue 2.x中的Object.definePro" />
  <meta property="og:locale" content="zh_CN" />
</head>
<body>
  <header class="site-header">
    <div class="container header-inner">
      <a class="logo" href="../index.html">面试题刷题</a>
      <nav class="nav">
        <a href="../index.html">首页</a>
        <a href="../index.html#categories">分类</a>
        <a href="https://github.com/pro-collection/interview-question/issues/395" target="_blank" rel="noopener">原始链接</a>
      </nav>
    </div>
  </header>
  <main class="container article">
    <div class="article-head">
      <a class="back" href="../index.html">← 返回列表</a>
      <h1>[vue] vue3 性能提升主要是体现在哪些方面【热度: 324】</h1>
      <div class="subtitle">web框架 · web框架 · Shopee</div>
      <div class="meta">创建：2023-05-31T15:49:39Z · 更新：2023-07-26T14:56:25Z</div>
    </div>
    <article class="content markdown-body"><p><strong>关键词</strong>：vue3 性能提升、vue3 编译优化、vue3 初始化优化、vue3 Tree-shaking支持、vue3 虚拟DOM优化</p><p>Vue 3.0在性能方面进行了多项改进和优化，主要体现在以下几个方面：</p><ol><li>响应式系统优化：Vue 3.0使用了基于Proxy的响应式系统，相比Vue 2.x中的Object.defineProperty，Proxy可以提供更高效的变更侦测和访问拦截，从而提升了响应式系统的性能。</li></ol><ol><li>编译优化：Vue 3.0引入了静态模板提升(Static Template Hoisting)技术，将模板编译为更简洁、更高效的渲染函数。这样可以减少不必要的运行时开销，并提高组件的渲染性能。</li></ol><ol><li>组件实例初始化优化：Vue 3.0在组件实例初始化过程中进行了一系列优化，减少了不必要的初始化工作和内存开销。例如，通过将组件的配置项合并为单个对象，避免了Vue 2.x中的原型链查找操作。</li></ol><ol><li>Tree-shaking支持：Vue 3.0的代码结构更加模块化，支持更好的Tree-shaking，可以更精确地将项目中没有使用的代码进行排除，从而减少打包体积。</li></ol><ol><li>虚拟DOM优化：Vue 3.0对虚拟DOM进行了一些优化，比如采用了静态标记(static marking)的方式来跳过静态节点的比对和更新，减少了不必要的操作，提高了渲染性能。</li></ol><p>这些优化和改进使得Vue 3.0在性能方面有了显著的提升，提高了应用的渲染性能、响应速度和整体的运行效率。</p><h2>Comments / Answers</h2><hr /><p><strong>yanlele</strong> at 2023-07-26T14:55:35Z</p><p>补充：</p><p><strong>相应式系统</strong></p><pre class="code-block"><code class="language-js">- Vue.js 2.x 中响应式系统的核心是 Object.defineProperty，劫持整个对象，然后进行深度遍历所有属性，给每个属性添加`getter`和`setter`，实现响应式
- Vue.js 3.x 中使用 Proxy 对象重写响应式系统
	- 可以监听动态新增的属性
	- 可以监听删除的属性
	- 可以监听数组的索引和length属性 

* 实现原理:

  * 通过Proxy（代理）: 拦截对象中任意属性的变化, 包括：属性值的读写、属性的添加、属性的删除等。

  * 通过Reflect（反射）: 对源对象的属性进行操作。

  * MDN文档中描述的Proxy与Reflect：

    * Proxy：[Proxy - JavaScript | MDN](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Proxy &quot;Proxy - JavaScript | MDN&quot;)

    * Reflect：[Reflect - JavaScript | MDN](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Reflect &quot;Reflect - JavaScript | MDN&quot;)
                                           
       new Proxy(data, {
          // 拦截读取属性值
          get (target, prop) {
              return Reflect.get(target, prop)
          },
          // 拦截设置属性值或添加新属性
          set (target, prop, value) {
              return Reflect.set(target, prop, value)
          },
          // 拦截删除属性
          deleteProperty (target, prop) {
              return Reflect.deleteProperty(target, prop)
          }
      })
  
      proxy.name = &#39;tom&#39;   ![]
</code></pre><p><strong>编译阶段</strong></p><ul><li>Vue.js 2.x 通过标记静态节点，优化 diff 的过程</li><li>Vue.js 3.x</li><li>vue.js 3.x中标记和提升所有的静态节点，diff的时候只需要对比动态节点内容；</li><li>Fragments（升级vetur插件): template中不需要唯一根节点，可以直接放文本或者同级标签</li><li>静态提升(hoistStatic),当使用 hoistStatic 时,所有静态的节点都被提升到 render 方法之外.只会在应用启动的时候被创建一次,之后使用只需要应用提取的静态节点，随着每次的渲染被不停的复用。</li><li>patch flag, 在动态标签末尾加上相应的标记,只能带 patchFlag 的节点才被认为是动态的元素,会被追踪属性的修改,能快速的找到动态节点,而不用逐个逐层遍历，提高了虚拟dom diff的性能。</li><li>缓存事件处理函数cacheHandler,避免每次触发都要重新生成全新的function去更新之前的函数</li></ul><p><strong>源码体积</strong></p><ul><li>相比Vue2，Vue3整体体积变小了，除了移出一些不常用的AP</li><li>tree shanking</li><li>任何一个函数，如ref、reavtived、computed等，仅仅在用到的时候才打包</li><li>通过编译阶段的静态分析，找到没有引入的模块并打上标记,将这些模块都给摇掉</li></ul></article>
  </main>
  <footer class="site-footer">© 面试题刷题 · 由本地静态页面生成</footer>
</body>
</html>