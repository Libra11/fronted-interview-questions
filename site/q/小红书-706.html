<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>交叉观察器 API IntersectionObserver 详解【热度: 665】 - 面试题刷题</title>
  <link rel="stylesheet" href="../assets/styles.css" />
  <meta name="description" content="&lt;p&gt;&lt;strong&gt;关键词&lt;/strong&gt;：交叉观察器 API、IntersectionObserver 详解&lt;/p&gt;&lt;p&gt;&lt;code&gt;IntersectionObserver&lt;/code&gt; API 是现代浏览器提供的一个强大的 API，用于性能友好地跟踪元素是否进入、离开或" />
  <link rel="icon" href="../assets/favicon.svg" />
  <style>.content a{color:var(--brand);} .content img{max-width:100%;}</style>
  
  <!-- Open Graph -->
  <meta property="og:title" content="交叉观察器 API IntersectionObserver 详解【热度: 665】" />
  <meta property="og:type" content="article" />
  <meta property="og:description" content="&lt;p&gt;&lt;strong&gt;关键词&lt;/strong&gt;：交叉观察器 API、IntersectionObserver 详解&lt;/p&gt;&lt;p&gt;&lt;code&gt;IntersectionObserver&lt;/code&gt; API 是现代浏览器提供的一个强大的 API，用于性能友好地跟踪元素是否进入、离开或穿过另一个元素（通常是视口）的边界。这个 API 特别适用于执行懒加载、实现无限滚动、检测广告展示等功能，因为它避免了使" />
  <meta property="og:locale" content="zh_CN" />
</head>
<body>
  <header class="site-header">
    <div class="container header-inner">
      <a class="logo" href="../index.html">面试题刷题</a>
      <nav class="nav">
        <a href="../index.html">首页</a>
        <a href="../index.html#categories">分类</a>
        <a href="https://github.com/pro-collection/interview-question/issues/706" target="_blank" rel="noopener">原始链接</a>
      </nav>
    </div>
  </header>
  <main class="container article">
    <div class="article-head">
      <a class="back" href="../index.html">← 返回列表</a>
      <h1>交叉观察器 API IntersectionObserver 详解【热度: 665】</h1>
      <div class="subtitle">小红书 · web应用场景 · 小红书</div>
      <div class="meta">创建：2024-04-19T14:59:19Z · 更新：2024-04-19T14:59:19Z</div>
    </div>
    <article class="content markdown-body"><p><strong>关键词</strong>：交叉观察器 API、IntersectionObserver 详解</p><p><code>IntersectionObserver</code> API 是现代浏览器提供的一个强大的 API，用于性能友好地跟踪元素是否进入、离开或穿过另一个元素（通常是视口）的边界。这个 API 特别适用于执行懒加载、实现无限滚动、检测广告展示等功能，因为它避免了使用传统的滚动事件监听，后者可能会因频繁的计算和 DOM 操作导致性能问题。</p><h3>如何使用 <code>IntersectionObserver</code>：</h3><ol><li><strong>创建一个<code>IntersectionObserver</code>实例</strong>:</li></ol><p>创建一个<code>IntersectionObserver</code>的新实例，你需要提供一个回调函数，该函数会在目标元素与其祖先或视口交叉状态变化时被调用。此外，你还可以提供一个选项对象来定义观察的具体条件。</p><ol><li><strong>观察元素</strong>:</li></ol><p>使用<code>observe</code>方法来指定一直观察的目标 DOM 元素。代表当这个 DOM 元素的显示与否达到某个条件时，你的回调函数将会被执行。</p><ol><li><strong>处理交叉事件</strong>:</li></ol><p>当观察的元素进入或离开另一个元素时，为创建<code>IntersectionObserver</code>实例时指定的回调函数将会被调用。</p><ol><li><strong>停止观察</strong>:</li></ol><p>使用<code>unobserve</code>方法可以停止观察特定元素。如果你已完成观察任务，使用<code>disconnect</code>方法将停止所有观察，释放资源。</p><h3>示例代码：</h3><p>以下是如何使用<code>IntersectionObserver</code>的示例：</p><pre class="code-block"><code class="language-javascript">// 创建一个回调函数，当观察的元素交叉进入或离开另一个元素时，该函数会被触发
const callback = (entries, observer) =&gt; {
  entries.forEach((entry) =&gt; {
    // 检查entry.isIntersecting属性
    if (entry.isIntersecting) {
      // 元素已进入视口
      console.log(&quot;Element is in the viewport!&quot;);
    } else {
      // 元素已离开视口
      console.log(&quot;Element is out of the viewport!&quot;);
    }
  });
};

// 创建IntersectionObserver实例
const options = {
  root: null, // 使用浏览器视口作为根
  rootMargin: &quot;0px&quot;, // 根的外边距，类似于CSS的margin
  threshold: 1.0, // 目标完全可见时触发回调
};

const observer = new IntersectionObserver(callback, options);

// 开始观察目标元素
const target = document.getElementById(&quot;yourTargetElementId&quot;);
observer.observe(target);

// 停止观察目标元素
// observer.unobserve(target);
</code></pre><p>在这个示例中，当目标元素（<code>id</code>为<code>yourTargetElementId</code>的元素）完全进入视口时，回调函数将被触发。<code>root</code>设为<code>null</code>意味着默认使用视口作为参照根元素。<code>rootMargin</code>设为<code>0px</code>表示根和目标的边界框触碰时回调就会被触发。<code>threshold</code>为<code>1.0</code>，表示目标完全可见时回调会被触发。</p><h3>注意事项</h3><ul><li><code>IntersectionObserver</code>在性能上比传统的滚动事件检测方式有显著优势，因为它不依赖于<code>JavaScript</code>在主线程上的事件循环。</li><li>使用时应当注意浏览器兼容性问题，对于不支持该 API 的旧浏览器，可能需要添加 polyfill 以保证功能的实现。</li></ul><h3>参考文档</h3><ul><li>https://developer.mozilla.org/zh-CN/docs/Web/API/Intersection_Observer_API</li><li>https://juejin.cn/post/7296058491289501696</li></ul></article>
  </main>
  <footer class="site-footer">© 面试题刷题 · 由本地静态页面生成</footer>
</body>
</html>