<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Nginx 中 proxy_pass 路径结尾加 / 与不加 /，对前端接口代理路径有何差异？举例说明。【热度: 106】 - 面试题刷题</title>
  <link rel="stylesheet" href="../assets/styles.css" />
  <meta name="description" content="&lt;p&gt;&lt;strong&gt;关键词&lt;/strong&gt;：nginx proxy_pass&lt;/p&gt;&lt;p&gt;Nginx 中 &lt;code&gt;proxy_pass&lt;/code&gt; 路径结尾是否加 &lt;code&gt;/&lt;/code&gt; 会直接影响代理后的 URL 拼接规则，对前端接口请求路径的映射结果有显著差异" />
  <link rel="icon" href="../assets/favicon.svg" />
  <style>.content a{color:var(--brand);} .content img{max-width:100%;}</style>
  
  <!-- Open Graph -->
  <meta property="og:title" content="Nginx 中 proxy_pass 路径结尾加 / 与不加 /，对前端接口代理路径有何差异？举例说明。【热度: 106】" />
  <meta property="og:type" content="article" />
  <meta property="og:description" content="&lt;p&gt;&lt;strong&gt;关键词&lt;/strong&gt;：nginx proxy_pass&lt;/p&gt;&lt;p&gt;Nginx 中 &lt;code&gt;proxy_pass&lt;/code&gt; 路径结尾是否加 &lt;code&gt;/&lt;/code&gt; 会直接影响代理后的 URL 拼接规则，对前端接口请求路径的映射结果有显著差异。理解这一差异是配置接口代理的关键。&lt;/p&gt;&lt;h3&gt;核心差异：路径拼接规则&lt;/h3&gt;&lt;p&gt;假设：&lt;/p&gt;&lt;ul&gt;&lt;li&gt;" />
  <meta property="og:locale" content="zh_CN" />
</head>
<body>
  <header class="site-header">
    <div class="container header-inner">
      <a class="logo" href="../index.html">面试题刷题</a>
      <nav class="nav">
        <a href="../index.html">首页</a>
        <a href="../index.html#categories">分类</a>
        <a href="https://github.com/pro-collection/interview-question/issues/1139" target="_blank" rel="noopener">原始链接</a>
      </nav>
    </div>
  </header>
  <main class="container article">
    <div class="article-head">
      <a class="back" href="../index.html">← 返回列表</a>
      <h1>Nginx 中 proxy_pass 路径结尾加 / 与不加 /，对前端接口代理路径有何差异？举例说明。【热度: 106】</h1>
      <div class="subtitle">web应用场景 · web应用场景</div>
      <div class="meta">创建：2025-09-07T05:54:52Z · 更新：2025-09-07T05:54:52Z</div>
    </div>
    <article class="content markdown-body"><p><strong>关键词</strong>：nginx proxy_pass</p><p>Nginx 中 <code>proxy_pass</code> 路径结尾是否加 <code>/</code> 会直接影响代理后的 URL 拼接规则，对前端接口请求路径的映射结果有显著差异。理解这一差异是配置接口代理的关键。</p><h3>核心差异：路径拼接规则</h3><p>假设：</p><ul><li>Nginx 配置的 <code>location</code> 匹配规则为 <code>/api</code></li><li>后端服务地址为 <code>http://backend:3000</code></li></ul><p>两种配置的区别如下：</p><p>| <code>proxy_pass</code> 配置                          | 拼接规则                                                         | 最终代理地址                            |</p><p>| ------------------------------------------ | ---------------------------------------------------------------- | --------------------------------------- |</p><p>| 不加 <code>/</code>：<code>proxy_pass http://backend:3000</code> | 将 <code>location</code> 匹配的路径（<code>/api</code>）<strong>完整拼接到后端地址后</strong>       | <code>http://backend:3000 + /api + 剩余路径</code> |</p><p>| 加 <code>/</code>：<code>proxy_pass http://backend:3000/</code>  | 将 <code>location</code> 匹配的路径（<code>/api</code>）<strong>替换为 <code>/</code></strong>，仅拼接剩余路径 | <code>http://backend:3000 + / + 剩余路径</code>    |</p><h3>举例说明（前端请求路径对比）</h3><p>假设前端发送请求：<code>http://nginx-host/api/user/list</code></p><h4>1. <code>proxy_pass</code> 不加 <code>/</code> 的情况</h4><pre class="code-block"><code class="language-nginx">location /api {
    # 后端地址末尾无 /
    proxy_pass http://backend:3000;
}
</code></pre><ul><li>匹配逻辑：<code>location /api</code> 匹配到请求中的 <code>/api</code> 部分</li><li>代理后地址：<code>http://backend:3000</code> + <code>/api</code> + <code>/user/list</code> → <code>http://backend:3000/api/user/list</code></li></ul><h4>2. <code>proxy_pass</code> 加 <code>/</code> 的情况</h4><pre class="code-block"><code class="language-nginx">location /api {
    # 后端地址末尾有 /
    proxy_pass http://backend:3000/;
}
</code></pre><ul><li>匹配逻辑：<code>location /api</code> 匹配到的 <code>/api</code> 被替换为 <code>/</code></li><li>代理后地址：<code>http://backend:3000/</code> + <code>/user/list</code> → <code>http://backend:3000/user/list</code></li></ul><h3>扩展场景：<code>location</code> 带多级路径时</h3><p>若 <code>location</code> 规则为 <code>/api/v1</code>，请求路径为 <code>http://nginx-host/api/v1/user/list</code></p><h4>1. 不加 <code>/</code></h4><pre class="code-block"><code class="language-nginx">location /api/v1 {
    proxy_pass http://backend:3000;
}
# 代理结果：http://backend:3000/api/v1/user/list
</code></pre><h4>2. 加 <code>/</code></h4><pre class="code-block"><code class="language-nginx">location /api/v1 {
    proxy_pass http://backend:3000/;
}
# 代理结果：http://backend:3000/user/list
</code></pre><h3>特殊场景：<code>proxy_pass</code> 包含子路径</h3><p>若 <code>proxy_pass</code> 不仅是域名/IP，还包含子路径（如 <code>http://backend:3000/service</code>），加不加 <code>/</code> 的规则依然适用：</p><h4>1. 后端路径不加 <code>/</code></h4><pre class="code-block"><code class="language-nginx">location /api {
    proxy_pass http://backend:3000/service;
}
# 请求 /api/user → 代理到 http://backend:3000/serviceapi/user
# （注意：/api 被完整拼接，导致 service 和 api 连在一起，通常不符合预期）
</code></pre><h4>2. 后端路径加 <code>/</code></h4><pre class="code-block"><code class="language-nginx">location /api {
    proxy_pass http://backend:3000/service/;
}
# 请求 /api/user → 代理到 http://backend:3000/service/user
# （正确拼接：/api 被替换为 /，剩余路径 /user 拼接到 service/ 后）
</code></pre><h3>总结</h3><ul><li><strong>不加 <code>/</code></strong>：<code>location</code> 匹配的路径会被完整拼接到 <code>proxy_pass</code> 地址后（适合后端接口路径与前端请求路径完全一致的场景）。</li><li><strong>加 <code>/</code></strong>：<code>location</code> 匹配的路径会被替换为 <code>/</code>，仅将剩余路径拼接到 <code>proxy_pass</code> 地址后（适合需要简化后端接口路径的场景）。</li></ul><p>实际配置时，建议通过 <code>curl</code> 测试或查看后端日志确认代理结果，避免因路径拼接错误导致接口 404。</p></article>
  </main>
  <footer class="site-footer">© 面试题刷题 · 由本地静态页面生成</footer>
</body>
</html>