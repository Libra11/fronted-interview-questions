<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>HTTPS 加密算法和加解密过程是啥？ - 面试题刷题</title>
  <link rel="stylesheet" href="../assets/styles.css" />
  <meta name="description" content="&lt;h3&gt;探究 HTTPS&lt;/h3&gt;&lt;p&gt;我说，你起这么牛逼的名字干嘛，还想吹牛批？你 HTTPS 不就抱上了 TLS/SSL 的大腿么，咋这么牛批哄哄的，还想探究 HTTPS，瞎胡闹，赶紧改成 TLS 是我主，赞美我主。&lt;/p&gt;&lt;p&gt;SSL 即&lt;code&gt;安全套接字层&lt;/code" />
  <link rel="icon" href="../assets/favicon.svg" />
  <style>.content a{color:var(--brand);} .content img{max-width:100%;}</style>
  
  <!-- Open Graph -->
  <meta property="og:title" content="HTTPS 加密算法和加解密过程是啥？" />
  <meta property="og:type" content="article" />
  <meta property="og:description" content="&lt;h3&gt;探究 HTTPS&lt;/h3&gt;&lt;p&gt;我说，你起这么牛逼的名字干嘛，还想吹牛批？你 HTTPS 不就抱上了 TLS/SSL 的大腿么，咋这么牛批哄哄的，还想探究 HTTPS，瞎胡闹，赶紧改成 TLS 是我主，赞美我主。&lt;/p&gt;&lt;p&gt;SSL 即&lt;code&gt;安全套接字层&lt;/code&gt;，它在 OSI 七层网络模型中处于第五层，SSL 在 1999 年被 &lt;code&gt;IETF(互联网工程组)&lt;/code" />
  <meta property="og:locale" content="zh_CN" />
</head>
<body>
  <header class="site-header">
    <div class="container header-inner">
      <a class="logo" href="../index.html">面试题刷题</a>
      <nav class="nav">
        <a href="../index.html">首页</a>
        <a href="../index.html#categories">分类</a>
        <a href="https://github.com/pro-collection/interview-question/issues/151" target="_blank" rel="noopener">原始链接</a>
      </nav>
    </div>
  </header>
  <main class="container article">
    <div class="article-head">
      <a class="back" href="../index.html">← 返回列表</a>
      <h1>HTTPS 加密算法和加解密过程是啥？</h1>
      <div class="subtitle">网络 · 网络</div>
      <div class="meta">创建：2023-03-26T05:58:20Z · 更新：2023-03-26T05:58:21Z</div>
    </div>
    <article class="content markdown-body"><h3>探究 HTTPS</h3><p>我说，你起这么牛逼的名字干嘛，还想吹牛批？你 HTTPS 不就抱上了 TLS/SSL 的大腿么，咋这么牛批哄哄的，还想探究 HTTPS，瞎胡闹，赶紧改成 TLS 是我主，赞美我主。</p><p>SSL 即<code>安全套接字层</code>，它在 OSI 七层网络模型中处于第五层，SSL 在 1999 年被 <code>IETF(互联网工程组)</code>更名为 TLS ，即<code>传输安全层</code>，直到现在，TLS 一共出现过三个版本，1.1、1.2 和 1.3 ，目前最广泛使用的是 1.2，所以接下来的探讨都是基于 TLS 1.2 的版本上的。</p><p>TLS 用于两个通信应用程序之间提供保密性和数据完整性。TLS 由<strong>记录协议、握手协议、警告协议、变更密码规范协议、扩展协议</strong>等几个子协议组成，综合使用了<strong>对称加密、非对称加密、身份认证</strong>等许多密码学前沿技术（如果你觉得一项技术很简单，那你只是没有学到位，任何技术都是有美感的，牛逼的人只是欣赏，并不是贬低）。</p><p>说了这么半天，我们还没有看到 TLS 的命名规范呢，下面举一个 TLS 例子来看一下 TLS 的结构（可以参考 <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.iana.org%2Fassignments%2Ftls-parameters%2Ftls-parameters.xhtml%25EF%25BC%2589 %22https://www.iana.org/assignments/tls-parameters/tls-parameters.xhtml%EF%BC%89%22" target="_blank" rel="noopener">www.iana.org/assignments…</a></p><pre class="code-block"><code>ECDHE-ECDSA-AES256-GCM-SHA384

</code></pre><p>这是啥意思呢？我刚开始看也有点懵啊，但其实是有套路的，因为 TLS 的密码套件比较规范，基本格式就是 <strong>密钥交换算法 - 签名算法 - 对称加密算法 - 摘要算法</strong> 组成的一个密码串，有时候还有<code>分组模式</code>，我们先来看一下刚刚是什么意思</p><p>使用 ECDHE 进行密钥交换，使用 ECDSA 进行签名和认证，然后使用 AES 作为对称加密算法，密钥的长度是 256 位，使用 GCM 作为分组模式，最后使用 SHA384 作为摘要算法。</p><p>TLS 在根本上使用<code>对称加密</code>和 <code>非对称加密</code> 两种形式。</p><h3>对称加密</h3><p>在了解对称加密前，我们先来了解一下<code>密码学</code>的东西，在密码学中，有几个概念：<strong>明文、密文、加密、解密</strong></p><ul><li><code>明文(Plaintext)</code>，一般认为明文是有意义的字符或者比特集，或者是通过某种公开编码就能获得的消息。明文通常用 m 或 p 表示</li><li><code>密文(Ciphertext)</code>，对明文进行某种加密后就变成了密文</li><li><code>加密(Encrypt)</code>，把原始的信息（明文）转换为密文的信息变换过程</li><li><code>解密(Decrypt)</code>，把已经加密的信息恢复成明文的过程。</li></ul><p><code>对称加密(Symmetrical Encryption)</code>顾名思义就是指<strong>加密和解密时使用的密钥都是同样的密钥</strong>。只要保证了密钥的安全性，那么整个通信过程也就是具有了机密性。</p><p>TLS 里面有比较多的加密算法可供使用，比如 DES、3DES、AES、ChaCha20、TDEA、Blowfish、RC2、RC4、RC5、IDEA、SKIPJACK 等。目前最常用的是 AES-128, AES-192、AES-256 和 ChaCha20。</p><p><code>DES</code> 的全称是 <code>Data Encryption Standard(数据加密标准)</code> ，它是用于数字数据加密的对称密钥算法。尽管其 56 位的短密钥长度使它对于现代应用程序来说太不安全了，但它在加密技术的发展中具有很大的影响力。</p><p><code>3DES</code> 是从原始数据加密标准（DES）衍生过来的加密算法，它在 90 年代后变得很重要，但是后面由于更加高级的算法出现，3DES 变得不再重要。</p><p>AES-128, AES-192 和 AES-256 都是属于 AES ，AES 的全称是<code>Advanced Encryption Standard(高级加密标准)</code>，它是 DES 算法的替代者，安全强度很高，性能也很好，是应用最广泛的对称加密算法。</p><p><code>ChaCha20</code> 是 Google 设计的另一种加密算法，密钥长度固定为 256 位，纯软件运行性能要超过 AES，曾经在移动客户端上比较流行，但 ARMv8 之后也加入了 AES 硬件优化，所以现在不再具有明显的优势，但仍然算得上是一个不错算法。</p><p>（其他可自行搜索）</p><h3>加密分组</h3><p>对称加密算法还有一个<code>分组模式</code> 的概念，对于 GCM 分组模式，只有和 AES，CAMELLIA 和 ARIA 搭配使用，而 AES 显然是最受欢迎和部署最广泛的选择，它可以让算法用固定长度的密钥加密任意长度的明文。</p><p>最早有 ECB、CBC、CFB、OFB 等几种分组模式，但都陆续被发现有安全漏洞，所以现在基本都不怎么用了。最新的分组模式被称为 <code>AEAD（Authenticated Encryption with Associated Data）</code>，在加密的同时增加了认证的功能，常用的是 GCM、CCM 和 Poly1305。</p><p>比如 <code>ECDHE_ECDSA_AES128_GCM_SHA256</code> ，表示的是具有 128 位密钥， AES256 将表示 256 位密钥。GCM 表示具有 128 位块的分组密码的现代认证的关联数据加密（AEAD）操作模式。</p><p>我们上面谈到了对称加密，对称加密的加密方和解密方都使用同一个<code>密钥</code>，也就是说，加密方必须对原始数据进行加密，然后再把密钥交给解密方进行解密，然后才能解密数据，这就会造成什么问题？这就好比《小兵张嘎》去送信（信已经被加密过），但是嘎子还拿着解密的密码，那嘎子要是在途中被鬼子发现了，那这信可就是被完全的暴露了。所以，对称加密存在风险。</p><h3>非对称加密</h3><p><code>非对称加密(Asymmetrical Encryption)</code> 也被称为<code>公钥加密</code>，相对于对称加密来说，非对称加密是一种新的改良加密方式。密钥通过网络传输交换，它能够确保及时密钥被拦截，也不会暴露数据信息。非对称加密中有两个密钥，一个是公钥，一个是私钥，公钥进行加密，私钥进行解密。公开密钥可供任何人使用，私钥只有你自己能够知道。</p><p>使用公钥加密的文本只能使用私钥解密，同时，使用私钥加密的文本也可以使用公钥解密。公钥不需要具有安全性，因为公钥需要在网络间进行传输，非对称加密可以解决<code>密钥交换</code>的问题。网站保管私钥，在网上任意分发公钥，你想要登录网站只要用公钥加密就行了，密文只能由私钥持有者才能解密。而黑客因为没有私钥，所以就无法破解密文。</p><p>非对称加密算法的设计要比对称算法难得多（我们不会探讨具体的加密方式），常见的比如 DH、DSA、RSA、ECC 等。</p><p>其中 <code>RSA</code> 加密算法是最重要的、最出名的一个了。例如 <code>DHE_RSA_CAMELLIA128_GCM_SHA256</code>。它的安全性基于 <code>整数分解</code>，使用两个超大素数的乘积作为生成密钥的材料，想要从公钥推算出私钥是非常困难的。</p><p><code>ECC（Elliptic Curve Cryptography）</code>也是非对称加密算法的一种，它基于<code>椭圆曲线离散对数</code>的数学难题，使用特定的曲线方程和基点生成公钥和私钥， ECDHE 用于密钥交换，ECDSA 用于数字签名。</p><p>TLS 是使用<code>对称加密</code>和<code>非对称加密</code> 的混合加密方式来实现机密性。</p><h3>混合加密</h3><p>RSA 的运算速度非常慢，而 AES 的加密速度比较快，而 TLS 正是使用了这种<code>混合加密</code>方式。在通信刚开始的时候使用非对称算法，比如 RSA、ECDHE ，首先解决<code>密钥交换</code>的问题。然后用随机数产生对称算法使用的<code>会话密钥（session key）</code>，再用<code>公钥加密</code>。对方拿到密文后用<code>私钥解密</code>，取出会话密钥。这样，双方就实现了对称密钥的安全交换。</p><p>现在我们使用混合加密的方式实现了机密性，是不是就能够安全的传输数据了呢？还不够，在机密性的基础上还要加上<code>完整性</code>、<code>身份认证</code>的特性，才能实现真正的安全。而实现完整性的主要手段是 <code>摘要算法(Digest Algorithm)</code></p><h3>摘要算法</h3><p>如何实现完整性呢？在 TLS 中，实现完整性的手段主要是 <code>摘要算法(Digest Algorithm)</code>。摘要算法你不清楚的话，MD5 你应该清楚，MD5 的全称是 <code>Message Digest Algorithm 5</code>，它是属于<code>密码哈希算法(cryptographic hash algorithm)</code>的一种，MD5 可用于从任意长度的字符串创建 128 位字符串值。尽管 MD5 存在不安全因素，但是仍然沿用至今。MD5 最常用于<code>验证文件</code>的完整性。但是，它还用于其他安全协议和应用程序中，例如 SSH、SSL 和 IPSec。一些应用程序通过向明文加盐值或多次应用哈希函数来增强 MD5 算法。</p><blockquote>什么是加盐？在密码学中，<code>盐</code>就是一项随机数据，用作哈希数据，密码或密码的<code>单向</code>函数的附加输入。盐用于保护存储中的密码。例如</blockquote><blockquote>什么是单向？就是在说这种算法没有密钥可以进行解密，只能进行单向加密，加密后的数据无法解密，不能逆推出原文。</blockquote><p>我们再回到摘要算法的讨论上来，其实你可以把摘要算法理解成一种特殊的压缩算法，它能够把任意长度的数据<code>压缩</code>成一种固定长度的字符串，这就好像是给数据加了一把锁。</p><p>除了常用的 MD5 是加密算法外，<code>SHA-1(Secure Hash Algorithm 1)</code> 也是一种常用的加密算法，不过 SHA-1 也是不安全的加密算法，在 TLS 里面被禁止使用。目前 TLS 推荐使用的是 SHA-1 的后继者：<code>SHA-2</code>。</p><p>SHA-2 的全称是<code>Secure Hash Algorithm 2</code> ，它在 2001 年被推出，它在 SHA-1 的基础上做了重大的修改，SHA-2 系列包含六个哈希函数，其摘要（哈希值）分别为 224、256、384 或 512 位：<strong>SHA-224, SHA-256, SHA-384, SHA-512</strong>。分别能够生成 28 字节、32 字节、48 字节、64 字节的摘要。</p><p>有了 SHA-2 的保护，就能够实现数据的完整性，哪怕你在文件中改变一个标点符号，增加一个空格，生成的文件摘要也会完全不同，不过 SHA-2 是基于明文的加密方式，还是不够安全，那应该用什么呢？</p><p>安全性更高的加密方式是使用 <code>HMAC</code>，在理解什么是 HMAC 前，你需要先知道一下什么是 MAC。</p><p>MAC 的全称是<code>message authentication code</code>，它通过 MAC 算法从消息和密钥生成，MAC 值允许验证者（也拥有秘密密钥）检测到消息内容的任何更改，从而保护了消息的数据完整性。</p><p>HMAC 是 MAC 更进一步的拓展，它是使用 MAC 值 + Hash 值的组合方式，HMAC 的计算中可以使用任何加密哈希函数，例如 SHA-256 等。</p><p>现在我们又解决了完整性的问题，那么就只剩下一个问题了，那就是<code>认证</code>，认证怎么做的呢？我们再向服务器发送数据的过程中，黑客（攻击者）有可能伪装成任何一方来窃取信息。它可以伪装成你，来向服务器发送信息，也可以伪装称为服务器，接受你发送的信息。那么怎么解决这个问题呢？</p><h3>认证</h3><p>如何确定你自己的唯一性呢？我们在上面的叙述过程中出现过公钥加密，私钥解密的这个概念。提到的私钥只有你一个人所有，能够辨别唯一性，所以我们可以把顺序调换一下，变成私钥加密，公钥解密。使用私钥再加上摘要算法，就能够实现<code>数字签名</code>，从而实现认证。</p><p>到现在，综合使用对称加密、非对称加密和摘要算法，我们已经实现了<strong>加密、数据认证、认证</strong>，那么是不是就安全了呢？非也，这里还存在一个<strong>数字签名的认证问题</strong>。因为私钥是是自己的，公钥是谁都可以发布，所以必须发布经过认证的公钥，才能解决公钥的信任问题。</p><p>所以引入了 <code>CA</code>，CA 的全称是 <code>Certificate Authority</code>，证书认证机构，你必须让 CA 颁布具有认证过的公钥，才能解决公钥的信任问题。</p><p>全世界具有认证的 CA 就几家，分别颁布了 DV、OV、EV 三种，区别在于可信程度。DV 是最低的，只是域名级别的可信，EV 是最高的，经过了法律和审计的严格核查，可以证明网站拥有者的身份（在浏览器地址栏会显示出公司的名字，例如 Apple、GitHub 的网站）。不同的信任等级的机构一起形成了层级关系。</p><p>通常情况下，数字证书的申请人将生成由私钥和公钥以及证书<code>签名请求（CSR）</code>组成的密钥对。CSR是一个编码的文本文件，其中包含公钥和其他将包含在证书中的信息（例如域名，组织，电子邮件地址等）。密钥对和 CSR生成通常在将要安装证书的服务器上完成，并且 CSR 中包含的信息类型取决于证书的验证级别。与公钥不同，申请人的私钥是安全的，永远不要向 CA（或其他任何人）展示。</p><p>生成 CSR 后，申请人将其发送给 CA，CA 会验证其包含的信息是否正确，如果正确，则使用颁发的私钥对证书进行数字签名，然后将其发送给申请人。</p><h3>总结</h3><p>本篇文章我们主要讲述了 HTTPS 为什么会出现 ，HTTPS 解决了 HTTP 的什么问题，HTTPS 和 HTTP 的关系是什么，TLS 和 SSL 是什么，TLS 和 SSL 解决了什么问题？如何实现一个真正安全的数据传输？</p><h3>文章参考</h3><ul><li>https://juejin.cn/post/6844904089495535624</li></ul><p><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.ssl.com%2Ffaqs%2Fwhat-is-a-certificate-authority%2F %22https://www.ssl.com/faqs/what-is-a-certificate-authority/%22" target="_blank" rel="noopener">www.ssl.com/faqs/what-i…</a></p><p><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.ibm.com%2Fsupport%2Fknowledgecenter%2Fen%2FSSFKSJ_7.1.0%2Fcom.ibm.mq.doc%2Fsy10670_.htm %22https://www.ibm.com/support/knowledgecenter/en/SSFKSJ_7.1.0/com.ibm.mq.doc/sy10670_.htm%22" target="_blank" rel="noopener">www.ibm.com/support/kno…</a></p><p><a href="https://link.juejin.cn?target=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FMessage_authentication_code %22https://en.wikipedia.org/wiki/Message_authentication_code%22" target="_blank" rel="noopener">en.wikipedia.org/wiki/Messag…</a></p><p><a href="https://link.juejin.cn?target=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FHMAC %22https://en.wikipedia.org/wiki/HMAC%22" target="_blank" rel="noopener">en.wikipedia.org/wiki/HMAC</a></p><p><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.quora.com%2FWhat-does-it-mean-to-add-a-salt-to-a-password-hash %22https://www.quora.com/What-does-it-mean-to-add-a-salt-to-a-password-hash%22" target="_blank" rel="noopener">www.quora.com/What-does-i…</a></p><p><a href="https://link.juejin.cn?target=https%3A%2F%2Fhpbn.co%2Ftransport-layer-security-tls%2F %22https://hpbn.co/transport-layer-security-tls/%22" target="_blank" rel="noopener">hpbn.co/transport-l…</a></p><p><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.ssl2buy.com%2Fwiki%2Fsymmetric-vs-asymmetric-encryption-what-are-differences %22https://www.ssl2buy.com/wiki/symmetric-vs-asymmetric-encryption-what-are-differences%22" target="_blank" rel="noopener">www.ssl2buy.com/wiki/symmet…</a></p><p><a href="https://link.juejin.cn?target=https%3A%2F%2Fcrypto.stackexchange.com%2Fquestions%2F26410%2Fwhats-the-gcm-sha-256-of-a-tls-protocol %22https://crypto.stackexchange.com/questions/26410/whats-the-gcm-sha-256-of-a-tls-protocol%22" target="_blank" rel="noopener">crypto.stackexchange.com/questions/2…</a></p><p><a href="https://link.juejin.cn?target=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FAdvanced_Encryption_Standard %22https://en.wikipedia.org/wiki/Advanced_Encryption_Standard%22" target="_blank" rel="noopener">en.wikipedia.org/wiki/Advanc…</a></p><p><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.comparitech.com%2Fblog%2Finformation-security%2F3des-encryption%2F %22https://www.comparitech.com/blog/information-security/3des-encryption/%22" target="_blank" rel="noopener">www.comparitech.com/blog/inform…</a></p><p>《极客时间-透析 HTTP 协议》</p><p><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.tutorialsteacher.com%2Fhttps%2Fhow-ssl-works %22https://www.tutorialsteacher.com/https/how-ssl-works%22" target="_blank" rel="noopener">www.tutorialsteacher.com/https/how-s…</a></p><p><a href="https://link.juejin.cn?target=https%3A%2F%2Fbaike.baidu.com%2Fitem%2F%25E5%25AF%2586%25E7%25A0%2581%25E7%25B3%25BB%25E7%25BB%259F%2F5823651 %22https://baike.baidu.com/item/%E5%AF%86%E7%A0%81%E7%B3%BB%E7%BB%9F/5823651%22" target="_blank" rel="noopener">baike.baidu.com/item/密码系统/5…</a></p><p><a href="https://link.juejin.cn?target=https%3A%2F%2Fbaike.baidu.com%2Fitem%2F%25E5%25AF%25B9%25E7%25A7%25B0%25E5%258A%25A0%25E5%25AF%2586%2F2152944%3Ffr%3Daladdin %22https://baike.baidu.com/item/%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86/2152944?fr=aladdin%22" target="_blank" rel="noopener">baike.baidu.com/item/对称加密/2…</a></p><p><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.ssl.com%2Ffaqs%2Ffaq-what-is-ssl%2F %22https://www.ssl.com/faqs/faq-what-is-ssl/%22" target="_blank" rel="noopener">www.ssl.com/faqs/faq-wh…</a></p><p><a href="https://link.juejin.cn?target=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FHTTPS %22https://en.wikipedia.org/wiki/HTTPS%22" target="_blank" rel="noopener">en.wikipedia.org/wiki/HTTPS</a></p><p><a href="https://link.juejin.cn?target=https%3A%2F%2Fsupport.google.com%2Fwebmasters%2Fanswer%2F6073543%3Fhl%3Den %22https://support.google.com/webmasters/answer/6073543?hl=en%22" target="_blank" rel="noopener">support.google.com/webmasters/…</a></p><p><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.cloudflare.com%2Flearning%2Fssl%2Fwhy-is-http-not-secure%2F %22https://www.cloudflare.com/learning/ssl/why-is-http-not-secure/%22" target="_blank" rel="noopener">www.cloudflare.com/learning/ss…</a></p><p><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.cisco.com%2Fc%2Fen%2Fus%2Fproducts%2Fsecurity%2Fwhat-is-network-security.html %22https://www.cisco.com/c/en/us/products/security/what-is-network-security.html%22" target="_blank" rel="noopener">www.cisco.com/c/en/us/pro…</a></p><p><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.freecodecamp.org%2Fnews%2Fweb-security-an-introduction-to-http-5fa07140f9b3%2F %22https://www.freecodecamp.org/news/web-security-an-introduction-to-http-5fa07140f9b3/%22" target="_blank" rel="noopener">www.freecodecamp.org/news/web-se…</a></p></article>
  </main>
  <footer class="site-footer">© 面试题刷题 · 由本地静态页面生成</footer>
</body>
</html>